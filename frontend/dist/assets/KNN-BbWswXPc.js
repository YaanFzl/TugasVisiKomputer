import{r as i,j as e,B as F,m as C}from"./index-CrUE8R_k.js";import{k as v}from"./api-eApqxtH2.js";import{U}from"./upload-D97uW7Ax.js";const M=()=>{const[h,b]=i.useState(null),[g,o]=i.useState(null),[u,f]=i.useState(null),[x,y]=i.useState(3),[m,w]=i.useState(20),[l,j]=i.useState(null),[p,c]=i.useState(!1),[N,d]=i.useState(null),k=async a=>{var t,r;const s=a.target.files[0];if(s){b(s),c(!0),d(null),o(null),j(null),console.log("Uploading file:",s.name);try{const n=await v.uploadDataset(s);console.log("Upload response:",n),o(n.preview),f(n.data_json),d(null)}catch(n){console.error("Upload failed:",n),d(`Gagal upload: ${((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.detail)||n.message}`),o(null),f(null)}finally{c(!1)}}},S=async()=>{var a,s;if(u){c(!0);try{const t=await v.train(x,m,u);j(t)}catch(t){console.error("Training failed:",t),d(`Pelatihan gagal: ${((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.detail)||t.message}`)}finally{c(!1)}}};return e.jsx("div",{className:"space-y-8",children:e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("h2",{className:"text-2xl font-bold mb-6 flex items-center gap-2 text-white",children:[e.jsx(F,{className:"text-[#00ff88]"}),"Klasifikasi KNN"]}),N&&e.jsx("div",{className:"mb-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg text-red-400 text-sm",children:N}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-2 border-dashed border-white/20 rounded-xl p-8 text-center hover:border-[#00ff88] transition-colors relative",children:[e.jsx("input",{type:"file",accept:".csv",onChange:k,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsxs("div",{className:"text-gray-400",children:[e.jsx(U,{className:"w-12 h-12 mx-auto mb-2"}),e.jsx("p",{children:h?h.name:"Upload Dataset CSV"}),p&&!g&&e.jsx("p",{className:"text-sm mt-2",children:"Memuat..."})]})]}),g&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:["Nilai K: ",x]}),e.jsx("input",{type:"range",min:"1",max:"20",value:x,onChange:a=>y(parseInt(a.target.value)),className:"w-full accent-[#00ff88]"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 text-gray-300",children:["Ukuran Test: ",m,"%"]}),e.jsx("input",{type:"range",min:"10",max:"50",value:m,onChange:a=>w(parseInt(a.target.value)),className:"w-full accent-[#00ff88]"})]}),e.jsx("button",{onClick:S,disabled:p,className:"w-full py-3 bg-white text-black font-bold rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50",children:p?"Melatih...":"Latih Model"})]})]}),e.jsx("div",{className:"space-y-4",children:l?e.jsxs(C.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[e.jsxs("div",{className:"glass-panel p-6 text-center bg-gradient-to-br from-[#00ff88]/10 to-transparent border-[#00ff88]/30",children:[e.jsxs("div",{className:"text-5xl font-bold text-[#00ff88] mb-2",children:[(l.accuracy*100).toFixed(2),"%"]}),e.jsx("div",{className:"text-gray-400 text-sm",children:"Akurasi Model"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"glass-panel p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[(l.precision*100).toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Presisi"})]}),e.jsxs("div",{className:"glass-panel p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-400",children:[(l.recall*100).toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Recall"})]}),e.jsxs("div",{className:"glass-panel p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-pink-400",children:[(l.f1_score*100).toFixed(1),"%"]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Skor F1"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"glass-panel p-4",children:[e.jsx("div",{className:"text-white font-bold text-lg",children:l.train_size}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Sampel Training"})]}),e.jsxs("div",{className:"glass-panel p-4",children:[e.jsx("div",{className:"text-white font-bold text-lg",children:l.test_size}),e.jsx("div",{className:"text-gray-500 text-xs",children:"Sampel Test"})]})]}),l.confusion_matrix&&e.jsxs("div",{className:"glass-panel p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-300 mb-3",children:"Matriks Konfusi"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-w-[200px] mx-auto",children:l.confusion_matrix.map((a,s)=>a.map((t,r)=>e.jsx("div",{className:"aspect-square flex items-center justify-center rounded-lg font-bold text-sm",style:{background:s===r?"rgba(0, 255, 136, 0.2)":"rgba(236, 72, 153, 0.2)",border:s===r?"1px solid rgba(0, 255, 136, 0.4)":"1px solid rgba(236, 72, 153, 0.4)",color:s===r?"#00ff88":"#ec4899"},children:t},`${s}-${r}`)))}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 text-center",children:[e.jsx("span",{className:"text-[#00ff88]",children:"■"})," Benar",e.jsx("span",{className:"ml-3 text-pink-400",children:"■"})," Salah"]})]})]}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-500 border border-white/10 rounded-xl bg-white/5 min-h-[400px]",children:e.jsx("p",{children:"Hasil pelatihan akan muncul di sini"})})})]})]})})};export{M as default};
